# Databricks notebook source
design = {'Charge':[('ALLOY', 'string'), ('ALLOYING_LBS', 'double'), ('ALLOY_RATIO', 'string'), ('BATCH_ID', 'string'), ('CHARGEID', 'string'), ('CHARGE_TEMPERATURE', 'double'), ('CreatedDate', 'string'), ('DataKey', 'string'), ('GAUGE_DESC', 'string'), ('GAUGE_ID', 'string'), ('HARDNERS_LBS', 'double'), ('HARD_RATIO', 'string'), ('HeaderId', 'bigint'), ('MACHID', 'string'), ('MACHINE_TYPE_ID', 'string'), ('MARKET_VALUE', 'double'), ('MATERIAL_FAMILY', 'string'), ('MATERIAL_ID', 'string'), ('MD5', 'string'), ('METAL_VALUE', 'string'), ('PIECES', 'bigint'), ('POST_CONSUMER_LBS', 'double'), ('POST_RATIO', 'string'), ('PRE_CONSUMER_LBS', 'double'), ('PRE_RATIO', 'string'), ('PRIMARY_LBS', 'double'), ('PRIM_RATIO', 'string'), ('RECLAIMED_LBS', 'double'), ('RECLAIM_RATIO', 'string'), ('RECORD_CREATE_DATE', 'string'), ('RECORD_CREATE_DATE_UTC', 'string'), ('RECORD_MODIFIED_DATE', 'string'), ('RECYCLE_CONTENT', 'string'), ('RECYCLE_RATIO', 'string'), ('RESERVED_DATE', 'string'), ('SHAPE_DESC', 'string'), ('SHAPE_ID', 'string'), ('SOURCE', 'string'), ('SOURCE_CATEGORY', 'string'), ('SchemaKey', 'string'), ('TICKET_ID', 'string'), ('TransactionDate', 'string'), ('UNIT', 'string'), ('UpdatedDate', 'string'), ('VERIFIED', 'string'), ('VERIFYING_EMPLOYEE_ID', 'string'), ('WEIGHT', 'double'), ('WORKCTR', 'string'), ('day', 'string'), ('month', 'string'), ('year', 'string')],
         'Ingot':[('BATCHNOOUTPUT', 'string'), ('BATCH_ID', 'string'), ('COMMENTS', 'string'), ('CreatedDate', 'string'), ('DISPOSITION', 'string'), ('DURATIONINSECONDS', 'long'), ('DataKey', 'string'), ('EQPTID', 'string'), ('GAUGE', 'double'), ('GAUGEUOM', 'string'), ('HeaderId', 'bigint'), ('L2CYCLEID', 'string'), ('L2INGOTNAME', 'string'), ('LENGTH', 'double'), ('LENGTHUOM', 'string'), ('MAINBATCHEPT', 'string'), ('MAKEASALLOY', 'string'), ('MD5', 'string'), ('MODIFIEDDATE', 'string'), ('ORDEREDGAUGE', 'double'), ('ORDEREDLENGTH', 'double'), ('ORDEREDWIDTH', 'double'), ('PCSGID', 'string'), ('PROCID', 'string'), ('PRODORDERID', 'string'), ('QUALITYCOMMENTS', 'string'), ('QUALITYCONDITIONID', 'string'), ('QUALITYCONDITIONTYPE', 'string'), ('QUALITYL2ID', 'string'), ('QUALITYRESPONSIBILITY', 'string'), ('QUALITYSEVERITY', 'string'), ('QUALITYWEIGHT', 'double'), ('QUALITYWEIGHTTYPE', 'string'), ('SECONDARYBATCH', 'string'), ('SECONDARYBATCHEPT', 'string'), ('SHOPID', 'string'), ('SchemaKey', 'string'), ('TransactionDate', 'string'), ('UTCWIPCHGDTTM', 'string'), ('UpdatedDate', 'string'), ('WEIGHT', 'double'), ('WEIGHTTYPE', 'string'), ('WEIGHTUOM', 'string'), ('WIDTH', 'double'), ('WIDTHUOM', 'string'), ('day', 'string'), ('month', 'string'), ('year', 'string')],
         'Chemistry':[('Al_LimitsFlag', 'string'), ('Al_UniformityFlag', 'string'), ('Al_pct', 'double'), ('AnalyzerName', 'string'), ('BATCH_ID', 'string'), ('B_LimitsFlag', 'string'), ('B_UniformityFlag', 'string'), ('B_pct', 'double'), ('Be_LimitsFlag', 'string'), ('Be_UniformityFlag', 'string'), ('Be_pct', 'double'), ('Bi_LimitsFlag', 'string'), ('Bi_UniformityFlag', 'string'), ('Bi_pct', 'double'), ('Ca_LimitsFlag', 'string'), ('Ca_UniformityFlag', 'string'), ('Ca_pct', 'double'), ('Cd_LimitsFlag', 'string'), ('Cd_UniformityFlag', 'string'), ('Cd_pct', 'double'), ('Cr_LimitsFlag', 'string'), ('Cr_UniformityFlag', 'string'), ('Cr_pct', 'double'), ('CreatedDate', 'string'), ('CreatorName', 'string'), ('Cu_LimitsFlag', 'string'), ('Cu_UniformityFlag', 'string'), ('Cu_pct', 'double'), ('DataKey', 'string'), ('Fe_LimitsFlag', 'string'), ('Fe_UniformityFlag', 'string'), ('Fe_pct', 'double'), ('Ga_LimitsFlag', 'string'), ('Ga_UniformityFlag', 'string'), ('Ga_pct', 'double'), ('HeaderId', 'bigint'), ('Instrument', 'string'), ('L2Id', 'string'), ('Li_LimitsFlag', 'string'), ('Li_UniformityFlag', 'string'), ('Li_pct', 'double'), ('LocalAlloy', 'string'), ('MD5', 'string'), ('Mg_LimitsFlag', 'string'), ('Mg_UniformityFlag', 'string'), ('Mg_pct', 'double'), ('Mn_LimitsFlag', 'string'), ('Mn_UniformityFlag', 'string'), ('Mn_pct', 'double'), ('Na_LimitsFlag', 'string'), ('Na_UniformityFlag', 'string'), ('Na_pct', 'double'), ('Ni_LimitsFlag', 'string'), ('Ni_UniformityFlag', 'string'), ('Ni_pct', 'double'), ('OverallStatus', 'string'), ('P_LimitsFlag', 'string'), ('P_UniformityFlag', 'string'), ('P_pct', 'double'), ('Pb_LimitsFlag', 'string'), ('Pb_UniformityFlag', 'string'), ('Pb_pct', 'double'), ('SampleType', 'string'), ('Sb_LimitsFlag', 'string'), ('Sb_UniformityFlag', 'string'), ('Sb_pct', 'double'), ('SchemaKey', 'string'), ('Si_LimitsFlag', 'string'), ('Si_UniformityFlag', 'string'), ('Si_pct', 'double'), ('Sn_LimitsFlag', 'string'), ('Sn_UniformityFlag', 'string'), ('Sn_pct', 'double'), ('Sr_LimitsFlag', 'string'), ('Sr_UniformityFlag', 'string'), ('Sr_pct', 'double'), ('Ti_LimitsFlag', 'string'), ('Ti_UniformityFlag', 'string'), ('Ti_pct', 'double'), ('TransactionDate', 'string'), ('UpdatedDate', 'string'), ('V_LimitsFlag', 'string'), ('V_UniformityFlag', 'string'), ('V_pct', 'double'), ('Zn_LimitsFlag', 'string'), ('Zn_UniformityFlag', 'string'), ('Zn_pct', 'double'), ('Zr_LimitsFlag', 'string'), ('Zr_UniformityFlag', 'string'), ('Zr_pct', 'double'), ('day', 'string'), ('month', 'string'), ('year', 'string')],
         'Melter':['Pair1_MF_Loop2_GasFlow_AI', 'Pair1_GasFlowCV_dg', 'Pair1_MF_Loop2_ComairFlow_AI', 'Controls_FcePressureFB_dg', 'Burner2_OilFlowCV_dg', 'Controls_RoofTempCV_dg', 'Burner1_BurnerID_pg', 'Pair1_Loop2_CombAirFlow_dg', 'Burner3_OilFlowPV_dg', 'Pair2_GasFlowPV_dg', 'Pair1_RegenCycleTimePV_dg', 'System_CombAirTemp_dg', 'Pair1_GasFlowPV_dg', 'Burner1_OilFlowCV_dg', 'Burner4_CombAirTemp_dg', 'System_BathTempHighAlarmSP_cg', 'Burner1_CombAirTemp_dg', 'Burner2_BurnerID_pg', 'System_O2AnalyzerPV_dg', 'Controls_FcePressurePV_dg', 'Pair2_RegenCycleTimePV_dg', 'Pair1_MF_Loop1_ComairFlow_AI', 'Burner3_OilFlowSP_dg', 'Pair2_CombAirFlowSP_dg', 'Pair2_CombAirFlowPV_dg', 'Pair1_GasFlowSP_dg', 'Burner1_OilFlowPV_dg', 'Burner4_OilFlowPV_dg', 'Burner1_BedsTemp_dg', 'Pair2_CombAirFlowCV_dg', 'Burner3_BedsTemp_dg', 'Burner3_CombAirTemp_dg', 'Pair2_PairID_pg', 'Burner2_CombAirTemp_dg', 'Burner1_AirFuelRationPV_dg', 'Motors_TappingOutput_dg', 'Pair2_AirFuelRatioSP_dg', 'System_BathTempLowAlarmSP_cg', 'Controls_RoofTempPV_dg', 'Pair1_MF_AirFlow_C', 'Pair1_Main_OilTotal_Used_dg', 'Burner4_BedsTemp_dg', 'Pair1_MF_GasFlow_C', 'Burner3_BurnerID_pg', 'Pair1_No1_OilFlow_dg', 'System_RecupOutTempPV_dg', 'Burner1_OilFlowSP_dg', 'Burner2_BedsTemp_dg', 'Burner4_OilFlowSP_dg', 'Pair1_Loop1_CombAirFlow_dg', 'Burner3_OilFlowCV_dg', 'Pair1_No3_OilFlow_dg', 'System_RecupInTempPV_dg', 'Controls_FcePressureCV_dg', 'Pair1_PairID_pg', 'Pair1_No4_OilFlow_dg', 'Pair2_GasFlowCV_dg', 'Pair1_AirFuelRatioSP_dg', 'Pair1_No2_OilFlow_dg', 'System_HighFireStatusSetSP_dg', 'Controls_RoofTempSP_dg', 'Burner4_AirFuelRationPV_dg', 'Burner2_OilFlowSP_dg', 'System_FlueTempPV_dg', 'Pair2_GasFlowSP_dg', 'System_CycleTime_dg', 'Burner4_BurnerID_pg', 'Burner4_OilFlowCV_dg', 'Pair1_CombAirFlowCV_dg', 'Pair1_MF_Loop1_GasFlow_AI', 'Pair1_CombAirFlowSP_dg', 'Burner2_OilFlowPV_dg', 'Pair1_CombAirFlowPV_dg', 'Pair1_MF_MainGasTotal_USE', 'Burner3_AirFuelRationPV_dg', 'Controls_FcePressureSP_cg', 'System_HighFireStatusResetSP_dg', 'Burner2_AirFuelRationPV_dg'],
         'Holder': ['Holder_SpoutTempPV_dg', 'Holder_RoofTempPV_dg', 'Holder_MetalLevel_dg', 'Holder_ID_cg', 'Holder_TiltAngle_dg', 'Holder_RoofTempSP_pg', 'System_CycleTime_dg', 'System_NewBatchCastLength_dg', 'Holder_RoofTempCV_dg', 'Holder_MetalWeight_dg'],
         'Caster': ['Recipe_MLC_PinPreset1_cg', 'Rod1_SP_dg', 'Recipe_MLC_FillRate3StartLevel_cg', 'Recipe_WaterConventional_TotalFlow1_cg', 'CastingSpeed_CV_dg', 'Recipe_Speed_CastSpd5Len_cg', 'Recipe_Msc_MoldLvlStart_cg', 'WaterConventional_TempPV_dg', 'Recipe_MLC_FillRate4StartLevel_cg', 'Recipe_Speed_CastSpd6_cg', 'Recipe_TroughLevel_cg', 'Recipe_WaterPulsing_WaterPitTime_cg', 'MLC3_MetalLevelPV_dg', 'Recipe_Msc_MoldLvl1Len_cg', 'Recipe_WaterConventional_TotalLenght1_cg', 'MLC4_MetalLevelSP_dg', 'Recipe_Msc_MoldLvl1_cg', 'Recipe_MLC_UncntrldFillDist_cg', 'MLC2_ID_pg', 'Recipe_Msc_MoldLvl4_cg', 'CastingSpeed_FB_dg', 'Recipe_RodSpeed_cg', 'Recipe_MLC_FillRateStart_cg', 'MLC1_Reference_dg', 'MLC3_MetalLevelSP_dg', 'Degasser_Rotor2_Load_PV_dg', 'Rod1_CV_dg', 'Recipe_Speed_CastSpd5_cg', 'MLC4_ID_pg', 'Misc_MLC_AverageMetal_Level_dg', 'Recipe_Speed_CastSpd4Len_cg', 'Recipe_Msc_MoldThickness_cg', 'Degasser_Rotor1_Speed_SP_dg', 'MLC5_MetalLevelPV_dg', 'Trough_Sensor3_MetalLevel_PV_dg', 'Recipe_Speed_CastSpd3Len_cg', 'WaterConventional_TotalMoldTable_Pressure1_dg', 'Filter1_BedTempSP_dg', 'Recipe_Speed_CastSpd2Len_cg', 'Recipe_Msc_MoldLvl2_cg', 'Degasser_Bath1TempPV_dg', 'Recipe_Speed_CastSpd6Len_cg', 'Degasser_Rotor1_CL2_PV_dg', 'Recipe_WaterConventional_TotalLenght6_cg', 'Trough_MetalTemp_PV_dg', 'Recipe_Msc_MoldHeight_cg', 'Misc_HCRFillLevel_dg', 'Recipe_WaterConventional_TotalLenght2_cg', 'Degasser_Rotor2_Speed_SP_dg', 'Recipe_Msc_NumberMolds_cg', 'Degasser_Rotor2_InertGas_PV_dg', 'WaterConventional_TotalFlowCV_dg', 'Recipe_WaterConventional_TotalLenght3_cg', 'Recipe_MLC_FillRate1_cg', 'Degasser_Rotor1_Speed_PV_dg', 'CastingSpeed_SP_dg', 'Misc_HCRFillLevelRampRate_dg', 'Recipe_Speed_CastSpdStart_cg', 'MLC4_ControlPinFB_dg', 'Misc_PlatenPosition_dg', 'MLC3_MetalLevelCV_dg', 'Recipe_Holder_TiltBackOffset_cg', 'Recipe_WaterConventional_TotalFlow3_cg', 'Recipe_LengthCastSP_cg', 'MLC5_ID_pg', 'Recipe_WaterConventional_TotalFlow5_cg', 'Misc_HCRFillTime_dg', 'Recipe_MLC_FillRate1StartLevel_cg', 'Recipe_Msc_MoldLvl4Len_cg', 'MLC4_MetalLevelCV_dg', 'MLC1_ControlPinFB_dg', 'Filter1_BedTempPV_dg', 'PitLevel_HotPV_dg', 'Recipe_WaterTempHiLimit_cg', 'Recipe_MLC_PinPreset5_cg', 'MLC3_Reference_dg', 'Recipe_MLC_PinPreset3_cg', 'Recipe_WaterPulsing_WaterTableTime_cg', 'Recipe_Speed_CastSpd2_cg', 'Recipe_Msc_MoldLvl6_cg', 'Recipe_WaterConventional_TotalFlow4_cg', 'MLC5_Reference_dg', 'Rod1_ID_pg', 'MLC4_Reference_dg', 'MLC2_MetalLevelCV_dg', 'Recipe_Holder_BathTempLoLim_dg', 'Misc_DropMetalCast_dg', 'Misc_CastLengthPV_dg', 'Recipe_Msc_MoldLvl3Len_cg', 'WaterConventional_TotalFlowSP_dg', 'MLC4_MetalLevelPV_dg', 'Trough_MetalLevel_SP_dg', 'CastingSpeed_PV_dg', 'Recipe_Msc_MoldLvl6Len_cg', 'Degasser_Rotor2_Speed_PV_dg', 'Recipe_PitWaterLevel_cg', 'Recipe_WaterConventional_TotalFlow2_cg', 'Recipe_Msc_MoldLvl5_cg', 'Recipe_MLC_FillRate2StartLevel_cg', 'Recipe_MLC_FillRate4_cg', 'Recipe_Holder_BathTempSP_dg', 'MLC1_MetalLevelSP_dg', 'Recipe_Msc_MoldLvl3_cg', 'Degasser_Rotor1_Load_PV_dg', 'CycleStatus_StatePos_dg', 'MLC5_ControlPinFB_dg', 'Recipe_WaterConventional_TotalStartFlow_cg', 'Recipe_MLC_FillRate2_cg', 'MLC2_ControlPinFB_dg', 'MLC1_MetalLevelCV_dg', 'Recipe_MLC_FillRate3_cg', 'MLC3_ControlPinFB_dg', 'Holder2_SpoutTemperaturePV_dg', 'Recipe_Holder_BathTempHiLim_dg', 'Recipe_Msc_Rev_cg', 'System_HolderSelected_dl', 'Recipe_Speed_CastSpd4_cg', 'Recipe_Msc_MLCCalibrationPoint_cg', 'Recipe_WaterTempLoLimit_cg', 'Recipe_Speed_CastSpd1Len_cg', 'Misc_IngotLength_dg', 'Rod1_Type_cg', 'WaterConventional_TotalFlowPV_dg', 'Recipe_Msc_MoldWidth_cg', 'MLC1_MetalLevelPV_dg', 'Recipe_Speed_CastSpd1_cg', 'Recipe_WaterConventional_TotalFlow6_cg', 'Degasser_Rotor1_InertGas_PV_dg', 'Recipe_WaterConventional_TotalLenght4_cg', 'MLC3_ID_pg', 'System_NewBatchCastLength_dg', 'Recipe_Msc_MoldLvl2Len_cg', 'Recipe_MLC_PinPreset2_cg', 'Degasser_Rotor2_CL2_PV_dg', 'Recipe_Msc_MoldLvl5Len_cg', 'MLC2_MetalLevelSP_dg', 'Recipe_WaterConventional_TotalLenght5_cg', 'Holder1_SpoutTemperaturePV_dg', 'Recipe_Speed_CastSpd3_cg', 'MLC5_MetalLevelSP_dg', 'MLC2_MetalLevelPV_dg', 'Recipe_TroughTemp_cg', 'MLC1_ID_pg', 'MLC2_Reference_dg', 'Recipe_MetalDegasTemp_dg', 'Trough_Sensor1_MetalLevel_PV_dg', 'MLC5_MetalLevelCV_dg', 'Rod1_PV_dg', 'Recipe_MLC_PinPreset4_cg'],
          'Decoter': ['Controls_FeedrateSP_dg', 'Controls_FcePressurePV_dg', 'Controls_FeedratePV_dg', 'Misc_KilnRollerBearingTemp2_dl', 'Controls_InletTempPV_dg', 'Misc_KilnRollerBearingTemp1_dl', 'Controls_AfterburnerOxygenFB_dg', 'Controls_CycloneTempSP_dg', 'Controls_InletTempSP_dg', 'Misc_ExitVibConveyorLevel_dg', 'Misc_KilnTempWTC1_dg', 'Controls_AfterburnerWaterSprayPV_dg', 'Controls_FcePressureSP_dg', 'Controls_KilnWaterSpraySP_dg', 'Controls_AfterburnerWaterSpraySP_dg', 'Controls_AfterburnerWaterSprayCV_dg', 'Misc_RecirculationInletTemp_dg', 'Controls_AfterburnerTempPV_dg', 'Controls_KilnOxygenSP_dg', 'Controls_KilnOxygenPV_dg', 'Controls_FcePressureFB_dg', 'Controls_KilnOxygenCV_dg', 'Controls_CycloneTempPV_dg', 'Controls_GasFlowCV_dg', 'Misc_KilnTempWTC4_dg', 'Controls_AfterburnerOxygenCV_dg', 'System_RunningSP_dg', 'Controls_KilnSpeedSP_dg', 'Controls_AirFuelRatioPV_dg', 'Controls_DuctWaterSprayCV_dg', 'Controls_GasFlowSP_dg', 'Misc_BaghouseDP_dg', 'Controls_AfterburnerTempCV_dg', 'Controls_CombAirFlowPV_dg', 'Controls_KilnWaterSprayCV_dg', 'Controls_AfterburnerOxygenSP_dg', 'Misc_RecirculationFanAmperage_dg', 'Controls_CombAirFlowFB_dg', 'Misc_HopperLevel1_dg', 'Misc_HopperLevel2_dg', 'Controls_GasFlowFB_dg', 'Controls_ExitTempCV_dg', 'Misc_KilnRollerBearingTemp4_dl', 'Misc_KilnAmperage_dg', 'Controls_DuctWaterSpraySP_dg', 'System_Running_Output_dg', 'Controls_AfterburnerOxygenPV_dg', 'Controls_ExitTempSP_dg', 'System_RunningResetSP_dg', 'Misc_KilnRollerBearingTemp7_dl', 'Controls_AfterburnerTempSP_dg', 'Controls_FcePressureCV_dg', 'Controls_KilnOxygenFB_dg', 'Controls_CycloneTempCV_dg', 'Controls_GasFlowPV_dg', 'Controls_AirFuelRatioSP_dg', 'Controls_InletTempCV_dg', 'Controls_KilnWaterSprayPV_dg', 'Misc_KilnTempWTC3_dg', 'Misc_RecirculationFanSpeed_dg', 'Controls_AfterburnerTempFB_dg', 'Controls_FeedrateCV_dg', 'Misc_KilnRollerBearingTemp6_dl', 'Controls_CycloneTempFB_dg', 'Controls_ExitTempFB_dg', 'Controls_ExitTempPV_dg', 'Misc_KilnRollerBearingTemp5_dl', 'Misc_KilnRollerBearingTemp8_dl', 'Misc_KilnTempWTC2_dg', 'Misc_KilnRollerBearingTemp3_dl', 'Controls_DuctWaterSprayPV_dg', 'Controls_KilnSpeedPV_dg', 'Controls_CombAirFlowCV_dg'],
          'SM':['Controls_FcePressurePV_dg', 'Controls_BathTempCV_dg', 'System_HighFireStatusSetSP_dg', 'Burner2_CombAirFlowCV_dg', 'Burner2_ExhaustTempSP_dg', 'Burner2_ExhaustTempCV_dg', 'Controls_FcePressureSP_dg', 'Pair1_GasFlowCV_dg', 'Burner1_ExhaustTempSP_dg', 'Burner2_PrimaryAirFlowPV_dg', 'Controls_RoofTempCV_dg', 'Burner1_CombAirFlowSP_dg', 'System_BathTempLowAlarmSP_cg', 'Burner1_CombAirFlowPV_dg', 'Controls_RoofTempPV_dg', 'Pair1_HeatDemand_dg', 'Burner1_BurnerID_pg', 'Controls_BathTempSP_cg', 'Burner2_CombAirFlowPV_dg', 'Burner2_PrimaryAirFlowCV_dg', 'Controls_RoofTempSP_cg', 'Pair1_AirFuelRatioPV_dg', 'Misc_SaltFeederRate_dg', 'Burner1_PrimaryAirFlowPV_dg', 'Pair1_GasFlowPV_dg', 'Pair1_PairRegenCycleTime_dg', 'Controls_Bottled_Output_dg', 'Pair1_GasFlowSP_dg', 'Burner1_BedTemp_dg', 'Burner2_BedsTemp_dg', 'Misc_LevelHeight_dg', 'Controls_FcePressureCV_dg', 'System_BathTempHighAlarmSP_cg', 'Burner2_ExhaustTempPV_dg', 'Burner1_PrimaryAirFlowCV_dg', 'Burner2_BurnerID_pg', 'Burner1_ExhaustTempCV_dg', 'Burner2_PrimaryAirFlowSP_dg', 'System_HighFireStatusResetSP_dg', 'Pair1_PairID_pg', 'Burner1_ExhaustTempPV_dg', 'Controls_BathTempPV_dg', 'Burner1_CombAirFlowCV_dg', 'Burner1_PrimaryAirFlowSP_dg', 'Burner2_CombAirFlowSP_dg', 'Pair1_AirFuelRatioSP_dg']
 }